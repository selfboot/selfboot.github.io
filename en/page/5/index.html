<!DOCTYPE html><html lang="[&quot;zh-CN&quot;,&quot;en&quot;,&quot;default&quot;]"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="baidu-site-verification" content="codeva-WUJTOV7jES"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Just For Fun | 知其然，知其所以然。知识广度是深度的副产品！</title><link rel="stylesheet" type="text/css" href="/css/normalize.min.css"><link rel="stylesheet" type="text/css" href="/css/pure-min.min.css"><link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"><script type="text/javascript" src="/js/jquery.min.js"></script><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml,en/atom.xml"><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;973c5bad683a49b8af76df256779f523&quot;}"></script><script async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><meta name="referrer" content="no-referrer-when-downgrade"><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QNFB9JLSPV"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QNFB9JLSPV');
</script><script async="" type="text/javascript" src="/js/clipboard.min.js"></script><script async="" type="text/javascript" src="/js/toastr.min.js"></script><link rel="stylesheet" href="/css/toastr.min.css"><script>function switchLanguage(lang) {
  var currentPath = window.location.pathname;
  var newPath;
  if (lang === 'en') {
    newPath = '/en' + currentPath.replace(/^\/(zh-CN\/)?/, '/');
  } else {
    newPath = currentPath.replace(/^\/en/, '');
  }
  window.location.href = newPath;
}</script><meta name="generator" content="Hexo 7.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Just For Fun</h1><a id="logo" href="/.">Just For Fun</a><div class="lang-select-wrapper"><i class="fas fa-globe"></i><select id="lang-select" onchange="switchLanguage(this.value)"><option value="zh-CN">中文</option><option value="en" selected="">English</option></select></div><p class="description">Know what it is, and know why it is so. The breadth of knowledge is a byproduct of its depth!</p></div><div id="nav-menu"><a href="/en/."><i class="fa fa-home"></i><span> Home</span></a><a href="/en/archives/"><i class="fa fa-archive"></i><span> Archive</span></a><a href="/en/aboutme.html"><i class="fa fa-user"></i><span> About</span></a><a href="/en/atom.xml"><i class="fa fa-rss"></i><span> RSS</span></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title"><a href="/en/2024/01/17/c++_string_cow/">Unexpected C++ String Modification Caused by COW (Copy-On-Write)</a></h1><div class="post-meta">2024/01/17</div><a class="disqus-comment-count" data-disqus-identifier="en/2024/01/17/c++_string_cow/" href="/en/2024/01/17/c++_string_cow/#disqus_thread"></a><div class="post-content"><p>Recently, a colleague encountered a strange problem where in C++, after copying a string and modifying the copy’s content, the original value was also changed. For those not very familiar with C++, this seems a bit “spooky”. In this article, we’ll discuss this issue in depth, starting from a simple reproduction of the problem, to the underlying principles, and the changes in the C++ standard.</p>
<p><img src="https://slefboot-1251736664.file.myqcloud.com/20240115_c++_string_cow_cover.png/webp" alt="C++ string modification of copy affects original content" srcset="https://slefboot-1251736664.file.myqcloud.com/20240115_c++_string_cow_cover.png/webp 1938w, https://slefboot-1251736664.file.myqcloud.com/20240115_c++_string_cow_cover.png/webp400 400w, https://slefboot-1251736664.file.myqcloud.com/20240115_c++_string_cow_cover.png/webp800 800w, https://slefboot-1251736664.file.myqcloud.com/20240115_c++_string_cow_cover.png/webp1600 1600w" sizes="(min-width: 1150px) 723px, (min-width: 48em) calc((100vw - 120px) * 3 / 4 - 50px), (min-width: 35.5em) calc((100vw - 75px), calc(100vw - 40px)" width="1938" height="1212"></p></div><p class="readmore"><a href="/en/2024/01/17/c++_string_cow/">Read More</a></p></div><div class="post"><h1 class="post-title"><a href="/en/2023/09/19/c++_symbol_resolution/">The Surprising Truth Behind C++ Symbol Redefinition</a></h1><div class="post-meta">2023/09/19</div><a class="disqus-comment-count" data-disqus-identifier="en/2023/09/19/c++_symbol_resolution/" href="/en/2023/09/19/c++_symbol_resolution/#disqus_thread"></a><div class="post-content"><p>In the article <a href="https://selfboot.cn/en/2023/09/07/protobuf_redefine/">Investigating the Mysterious Field Loss Problem When Using Protobuf in C++</a>, we analyzed how two identical proto files led to linking the wrong pb, ultimately causing some fields to be lost during deserialization. At that time, we also mentioned the process of symbol resolution, where whether it’s dynamic linking or static linking, the symbol definition from the library listed earlier is actually used. I thought I had a deep understanding of this, until I recently encountered another strange “<strong>symbol redefinition</strong>“ problem.</p>
<p><img src="https://slefboot-1251736664.file.myqcloud.com/20230918_c++_symbol_resolution_index.webp/webp" alt="C++ Symbol Compilation and Linking Overview" srcset="https://slefboot-1251736664.file.myqcloud.com/20230918_c++_symbol_resolution_index.webp/webp 1400w, https://slefboot-1251736664.file.myqcloud.com/20230918_c++_symbol_resolution_index.webp/webp400 400w, https://slefboot-1251736664.file.myqcloud.com/20230918_c++_symbol_resolution_index.webp/webp800 800w" sizes="(min-width: 1150px) 723px, (min-width: 48em) calc((100vw - 120px) * 3 / 4 - 50px), (min-width: 35.5em) calc((100vw - 75px), calc(100vw - 40px)" width="1400" height="902"></p></div><p class="readmore"><a href="/en/2023/09/19/c++_symbol_resolution/">Read More</a></p></div><div class="post"><h1 class="post-title"><a href="/en/2023/09/09/protobuf_field_merge/">Analysis of Storage Failure Caused by Protobuf Serialized Messages</a></h1><div class="post-meta">2023/09/09</div><a class="disqus-comment-count" data-disqus-identifier="en/2023/09/09/protobuf_field_merge/" href="/en/2023/09/09/protobuf_field_merge/#disqus_thread"></a><div class="post-content"><p>Previously, I encountered a problem in actual business where Protobuf serialized messages caused storage failures. At that time, this issue almost led to a major failure, but I didn’t write an article to properly reflect on it. Recently, I encountered another Protobuf problem, and after writing <a href="https://selfboot.cn/en/2023/09/07/protobuf_redefine/">Investigating the Mysterious Field Loss Problem When Using Protobuf in C++</a>, I was reminded of the previous issue. Here, I’d like to write another article to properly introduce the pitfall I encountered last time.</p>
<p><img src="https://slefboot-1251736664.file.myqcloud.com/20230910_protobuf_field_merge_summary.png/webp" alt="Analysis of Storage Failure Caused by Protobuf Serialized Messages" srcset="https://slefboot-1251736664.file.myqcloud.com/20230910_protobuf_field_merge_summary.png/webp 2172w, https://slefboot-1251736664.file.myqcloud.com/20230910_protobuf_field_merge_summary.png/webp400 400w, https://slefboot-1251736664.file.myqcloud.com/20230910_protobuf_field_merge_summary.png/webp800 800w, https://slefboot-1251736664.file.myqcloud.com/20230910_protobuf_field_merge_summary.png/webp1600 1600w" sizes="(min-width: 1150px) 723px, (min-width: 48em) calc((100vw - 120px) * 3 / 4 - 50px), (min-width: 35.5em) calc((100vw - 75px), calc(100vw - 40px)" width="2172" height="1220"></p></div><p class="readmore"><a href="/en/2023/09/09/protobuf_field_merge/">Read More</a></p></div><nav class="page-navigator"><a class="extend prev" rel="prev" href="/en/page/4/">Previous</a><a class="page-number" href="/en/">1</a><span class="space">…</span><a class="page-number" href="/en/page/3/">3</a><a class="page-number" href="/en/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/en/page/6/">6</a><a class="extend next" rel="next" href="/en/page/6/">Next</a></nav><script id="dsq-count-scr" src="https://xuelangZF.disqus.com/count.js" async=""></script></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="https://www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="https://selfboot.cn"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"></i><span>Categories</span></div><ul><li><a href="/en/categories/Programming/">Programming</a> (9)</li><li><a href="/en/categories/Artificial-Intelligence/">Artificial Intelligence</a> (2)</li><li><a href="/en/categories/Source-Code-Analysis/">Source Code Analysis</a> (6)</li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"></i><span>Tags</span></div><div class="tagcloud"><a href="/en/tags/Python/" style="font-size: 15.00px;">Python</a> <a href="/en/tags/C/" style="font-size: 15.00px;">C++</a> <a href="/en/tags/Debug/" style="font-size: 15.00px;">Debug</a> <a href="/en/tags/Go/" style="font-size: 15.00px;">Go</a> <a href="/en/tags/LLM/" style="font-size: 15.00px;">LLM</a> <a href="/en/tags/Web/" style="font-size: 15.00px;">Web</a> <a href="/en/tags/LevelDB/" style="font-size: 15.00px;">LevelDB</a></div></div><!-- Debug: page.path = en/page/5/index.html --><div class="widget"><div class="widget-title"><i class="fa fa-file-o"></i><span>Recent</span></div><ul><li><a href="/en/2024/08/14/leveldb_source_wal_log/" title="LevelDB Explained - How To Read and Write WAL Logs">LevelDB Explained - How To Read and Write WAL Logs</a></li><li><a href="/en/2024/08/13/leveldb_source_unstand_c++/" title="LevelDB Explained -  Understanding Advanced C++ Techniques">LevelDB Explained -  Understanding Advanced C++ Techniques</a></li><li><a href="/en/2024/08/08/leveldb_source_bloom_filter/" title="LevelDB Explained - Bloom Filter Implementation and Visualization">LevelDB Explained - Bloom Filter Implementation and Visualization</a></li><li><a href="/en/2024/08/06/leveldb_source_prepare/" title="LevelDB Explained - Preparing the Development Environment">LevelDB Explained - Preparing the Development Environment</a></li><li><a href="/en/2024/08/02/leveldb_source_env_posixfile/" title="LevelDB Explained - Posix File Operation Details">LevelDB Explained - Posix File Operation Details</a></li><li><a href="/en/2024/07/22/leveldb_source_nodestructor/" title="LevelDB Explained - Preventing C++ Object Destruction">LevelDB Explained - Preventing C++ Object Destruction</a></li><li><a href="/en/2024/06/22/claude35_artifacts/" title="Creating Games Using Free Claude3.5 with Artifacts">Creating Games Using Free Claude3.5 with Artifacts</a></li><li><a href="/en/2024/06/13/async_pool_block_problem/" title="How an Async Thread Pool Exception Caused Service Chaos">How an Async Thread Pool Exception Caused Service Chaos</a></li><li><a href="/en/2024/05/19/stream_sse_chunk/" title="Understand Web Stream Output Implementation with Examples">Understand Web Stream Output Implementation with Examples</a></li><li><a href="/en/2024/05/10/c++_object_model/" title="Dive into C++ Object Memory Layout with Examples">Dive into C++ Object Memory Layout with Examples</a></li></ul></div><!-- Debug: Current Language = en, Filtered Posts Count = 10 --></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2024 <a href="/." rel="nofollow">Just For Fun.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/selfboot/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/selfboot"> SelfBoot.</a><p><span id="busuanzi_container_site_pv"></span>Total Site Visits:  <span id="busuanzi_value_site_pv"></span> Times，<span id="busuanzi_container_site_uv"></span>Unique Visitors:  <span id="busuanzi_value_site_uv"></span> People</p></div></div></div><link rel="stylesheet" type="text/css" href="/css/donate.css"><link rel="stylesheet" type="text/css" href="/css/copyright.css"><a class="show" id="rocket" href="#top" aria-label="Back to top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script><script type="text/javascript" src="/js/jquery.fancybox.min.js" defer=""></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" defer=""></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>