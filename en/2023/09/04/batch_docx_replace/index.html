<!DOCTYPE html><html lang="[&quot;zh-CN&quot;,&quot;en&quot;,&quot;default&quot;]"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="baidu-site-verification" content="codeva-NxrUEx2EFN"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="This article introduces how to use Python's docxtpl library to batch create Word documents, including simple text replacement while preserving styles, handling Excel date formats, inserting calculation results, conditional statements, and other techniques. By reading Excel data with pandas and rendering templates, dozens of Word files can be generated in batch within 1 minute. This avoids the inefficiency and errors of manual operations. Using programs to automate and improve work efficiency is a typical application scenario for Python."><title>Using Python Template Library docxtpl to Batch Create Word Documents</title><link rel="stylesheet" type="text/css" href="/css/normalize.min.css"><link rel="stylesheet" type="text/css" href="/css/pure-min.min.css"><link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"><script type="text/javascript" src="/js/jquery.min.js"></script><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml,en/atom.xml"><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;973c5bad683a49b8af76df256779f523&quot;}"></script>
<script defer="" src="https://cloud.umami.is/script.js" data-website-id="3578d9f2-9ea0-49d4-8781-e8d1217ab924"></script><script async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><meta name="referrer" content="no-referrer-when-downgrade"><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QNFB9JLSPV"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QNFB9JLSPV');
</script><script async="" type="text/javascript" src="/js/clipboard.min.js"></script><script async="" type="text/javascript" src="/js/toastr.min.js"></script><link rel="stylesheet" href="/css/toastr.min.css"><script>function switchLanguage(lang) {
  var currentPath = window.location.pathname;
  var newPath;
  if (lang === 'en') {
    newPath = '/en' + currentPath.replace(/^\/(zh-CN\/)?/, '/');
  } else {
    newPath = currentPath.replace(/^\/en/, '');
  }
  window.location.href = newPath;
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><a id="logo" href="/.">Just For Fun</a><div class="lang-select-wrapper"><i class="fas fa-globe"></i><select id="lang-select" onchange="switchLanguage(this.value)"><option value="zh-CN">中文</option><option value="en" selected="">English</option></select></div><p class="description">Know what it is, and know why it is so. The breadth of knowledge is a byproduct of its depth!</p></div><div id="nav-menu"><a href="/en/."><i class="fa fa-home"></i><span> Home</span></a><a href="/en/archives/"><i class="fa fa-archive"></i><span> Archive</span></a><a href="/en/aboutme.html"><i class="fa fa-user"></i><span> About</span></a><a href="/en/atom.xml"><i class="fa fa-rss"></i><span> RSS</span></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Using Python Template Library docxtpl to Batch Create Word Documents</h1><div class="post-meta">2023/09/04<span> | </span><span class="category"><a href="/categories/Programming/">Programming</a></span><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a class="disqus-comment-count" data-disqus-identifier="en/2023/09/04/batch_docx_replace/" href="/en/2023/09/04/batch_docx_replace/#disqus_thread"></a><div class="post-content"><p>In work, repetitive labor is often tedious. Leveraging the power of Python to optimize workflows can greatly improve efficiency and achieve twice the result with half the effort. This article will detail how to use the Python template library docxtpl to <strong>automatically generate multiple Word documents in a very short time</strong>, saving a lot of manual operation time, thus freeing up your hands and easily completing tasks.</p>
<p><img src="https://slefboot-1251736664.file.myqcloud.com/20230904_batch_docx_replace_summary.png/webp" alt="Python docxtpl batch creation of Word files" srcset="https://slefboot-1251736664.file.myqcloud.com/20230904_batch_docx_replace_summary.png/webp 2264w, https://slefboot-1251736664.file.myqcloud.com/20230904_batch_docx_replace_summary.png/webp400 400w, https://slefboot-1251736664.file.myqcloud.com/20230904_batch_docx_replace_summary.png/webp800 800w, https://slefboot-1251736664.file.myqcloud.com/20230904_batch_docx_replace_summary.png/webp1600 1600w" sizes="(min-width: 1150px) 723px, (min-width: 48em) calc((100vw - 120px) * 3 / 4 - 50px), (min-width: 35.5em) calc((100vw - 75px), calc(100vw - 40px)" width="2264" height="1270"></p>
<p><strong>Update: It’s a bit difficult for beginners to do it with Python. So I wrote an online tool that supports batch generation of Word documents from templates and data. <a target="_blank" rel="noopener" href="https://gallery.selfboot.cn/en/tools/gendocx">Online Batch Generate Word Tool Address</a></strong></p>
<span id="more"></span>

<p>The story begins like this: <a href="https://selfboot.cn/links">Lawyer Xiao Sheng</a> has a batch of cases where the case details for each client are similar, with only differences in the client’s name, ID number, address, and other information. Lawyer Xiao Sheng needs to prepare Word files for each client, where everything in the Word document is the same except for the client’s personal information.</p>
<p>Lawyer Xiao Sheng has an Excel file that records the client’s information. According to the previous method, she would need to open Excel, then copy and paste information one by one into each client’s Word file, and finally save it. This workload is huge; with dozens of clients, and multiple pieces of data for each client, she would need to copy and paste hundreds of times. Besides the large amount of physical labor, it’s also easy to make mistakes. A lawyer’s work is to avoid errors, so this method is not feasible.</p>
<p><strong>Since it’s repetitive physical labor, programs can certainly come in handy, as machines are precise and fast at repetition.</strong> So, Lawyer Xiao Sheng found me, hoping I could help her write a program to automatically create appropriate Word files based on the data in the Excel file.</p>
<h2 id="Simple-Replacement"><a href="#Simple-Replacement" class="headerlink" title="Simple Replacement"></a>Simple Replacement</h2><p>Xiao Sheng <strong>said her requirement was very simple</strong>: read data from Excel, replace it in Word, and then <strong>gave me 5 minutes</strong> to get it done (showing great potential as a product manager). So I habitually consulted ChatGPT teacher first, asking it to write the code. After communicating with it for half a day and continuously refining the requirements, I finally persuaded the AI to give up using the <code>python-docx</code> library.</p>
<p>Because while replacing the text, I needed to <strong>preserve the original file’s style</strong>. In Word’s <code>.docx</code> files, styles and text are stored separately. The text in a paragraph may consist of multiple Run objects, each of which may have different styles. Replacing text across multiple Run objects while preserving the format would be very complex. Moreover, this library’s API is also quite complex, requiring understanding of Run objects, which is not user-friendly. Fortunately, I was smart enough to remind ChatGPT to consider other libraries for text replacement, so ChatGPT teacher recommended the <code>docxtpl</code> library.</p>
<p><img src="https://slefboot-1251736664.file.myqcloud.com/20230904_batch_docx_replace_package.png/webp" alt="Python docxtpl batch creation of Word files" srcset="https://slefboot-1251736664.file.myqcloud.com/20230904_batch_docx_replace_package.png/webp 1668w, https://slefboot-1251736664.file.myqcloud.com/20230904_batch_docx_replace_package.png/webp400 400w, https://slefboot-1251736664.file.myqcloud.com/20230904_batch_docx_replace_package.png/webp800 800w, https://slefboot-1251736664.file.myqcloud.com/20230904_batch_docx_replace_package.png/webp1600 1600w" sizes="(min-width: 1150px) 723px, (min-width: 48em) calc((100vw - 120px) * 3 / 4 - 50px), (min-width: 35.5em) calc((100vw - 75px), calc(100vw - 40px)" width="1668" height="746"></p>
<p><code>docxtpl</code> is a template library based on <code>python-docx</code>. Its author found it too troublesome to modify Word using the python-docx library, so he developed the <code>docxtpl</code> library, drawing inspiration from the Jinja2 template library. It’s simple to use, mainly in three steps:</p>
<ol>
<li>Wrap the text to be replaced with <code>{{ }}</code> in the Word document;</li>
<li>Use the <code>DocxTemplate</code> class of <code>docxtpl</code> to load the Word template and provide the content before and after replacement;</li>
<li>Use the <code>render</code> method to render the template.</li>
</ol>
<p>This is much simpler. After getting Lawyer Xiao Sheng’s sample Word file, I simply modified it into a template file that conforms to Jinja2 syntax. If a certain field needs to be obtained from column B of the table, just write it as <code>{{ B }}</code>. For example, the following content:</p>
<blockquote>
<p>The case of <code>{{ A }}</code> vs <code>{{ B }}</code> lease contract dispute accepted by your court</p>
</blockquote>
<p>These template variables can be styled in Word, such as font, font size, color, etc. Then use pandas to read columns A and B from Excel, and use <code>docxtpl</code> to quickly perform text replacement while preserving the format. The core code is very simple, as follows:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">generate_word_files</span>(<span class="params">excel_filepath, word_template_filepath, output_dir</span>):</span><br><span class="line">    df = pd.read_excel(excel_filepath)</span><br><span class="line">    skip_max_rownum = <span class="number">1</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">for</span> index, row <span class="keyword">in</span> df.iloc[skip_max_rownum:].iterrows():</span><br><span class="line">        doc = DocxTemplate(word_template_filepath)</span><br><span class="line">        context = {}</span><br><span class="line">        <span class="keyword">for</span> i, col_value <span class="keyword">in</span> <span class="built_in">enumerate</span>(row):</span><br><span class="line">            col_label = excel_col_label(i)</span><br><span class="line">            context[col_label] = col_value</span><br><span class="line">        doc.render(context)</span><br><span class="line">        new_filename = <span class="string">f"demo_<span class="subst">{row.iloc[<span class="number">1</span>]}</span>.docx"</span></span><br><span class="line">        new_filepath = os.path.join(output_dir, new_filename)</span><br><span class="line">        doc.save(new_filepath)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="Special-Handling-of-Dates"><a href="#Special-Handling-of-Dates" class="headerlink" title="Special Handling of Dates"></a>Special Handling of Dates</h3><p>After writing the code and executing the replacement, I found that some fields were not correctly replaced. In Excel, there was a column that looked like a date ‘2023/04/12’, but after replacement in Word, it became 1970.1.1. What’s going on?</p>
<p>After printing the value read by pandas, I found it was an integer, not a string. This is because dates in Excel are based on <code>January 1, 1900</code>, so 2023/04/12 in Excel has a value of 44397. This value represents the number of days Excel uses to represent dates, not a string. Knowing this, we just need to add this number of days to the start date. Here’s the code ChatGPT provided:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">excel_date_to_datetime</span>(<span class="params">excel_date</span>):</span><br><span class="line">    <span class="keyword">if</span> pd.isna(excel_date):</span><br><span class="line">        <span class="keyword">return</span> pd.Timestamp(<span class="string">'1970-01-01'</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> datetime(<span class="number">1899</span>, <span class="number">12</span>, <span class="number">30</span>) + timedelta(days=<span class="built_in">float</span>(excel_date))</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"Failed to convert date: <span class="subst">{e}</span>"</span>)</span><br><span class="line">        <span class="keyword">return</span> pd.Timestamp(<span class="string">'1970-01-01'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>Here, the start date has become <code>1899.12.30</code>. This is because there’s an error in Excel’s date system: it treats 1900 as a leap year, which it actually isn’t. Therefore, February 1900 has 29 days in Excel’s date system. To solve this problem, a common practice is to start counting from December 30, 1899, which allows skipping this “extra” day (i.e., February 29, 1900) when calculating dates. ChatGPT teacher is indeed smart, automatically helping me avoid this pitfall.</p>
<p>For more information about Excel’s date format, you can refer to these two articles:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://support.microsoft.com/en-us/office/date-systems-in-excel-e7fe7167-48a9-4b96-bb53-5612a800b487">Date systems in Excel</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/office/troubleshoot/excel/wrongly-assumes-1900-is-leap-year">Excel incorrectly assumes that the year 1900 is a leap year</a></li>
</ul>
<h2 id="Complex-Replacement"><a href="#Complex-Replacement" class="headerlink" title="Complex Replacement"></a>Complex Replacement</h2><p>Simple replacement is of course not challenging, but we may encounter some more complex replacement scenarios in our work.</p>
<h3 id="Calculated-Data"><a href="#Calculated-Data" class="headerlink" title="Calculated Data"></a>Calculated Data</h3><p>As it happens, Lawyer Xiao Sheng’s file contains some calculation formulas that require filling in some calculated values, such as:</p>
<blockquote>
<p>The defendant’s loss is: <code>{{ Y }}</code> × 120% = ??? yuan</p>
</blockquote>
<p>Here, column Y in Excel is the loss fee, but it needs to be multiplied by a coefficient and filled into Word. Excel doesn’t have this calculated data, so we can calculate the result in the code and then wrap it with <code>{{ Y_calculated }}</code> to replace it in Word. The calculation part of the code is also very simple, as follows:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elif</span> col_label == <span class="string">'Y'</span>:</span><br><span class="line">    context[col_label] = <span class="built_in">int</span>(col_value)</span><br><span class="line">    context[<span class="string">'Y_calculated'</span>] = <span class="built_in">int</span>(col_value * <span class="number">1.2</span>)  <span class="comment"># Pre-calculate</span></span><br></pre></td></tr></tbody></table></figure>

<p>Actually, it would be even better if calculations could be supported in the Jinja2 template, such as writing the template as <code>{{ Y | calculate }}</code>, which would allow direct calculation in the template. However, <code>docxtpl</code> doesn’t support such syntax, so we can only calculate the result in the code and then replace it in Word.</p>
<h3 id="Conditional-Statements"><a href="#Conditional-Statements" class="headerlink" title="Conditional Statements"></a>Conditional Statements</h3><p>Xiao Sheng’s document also needs to dynamically display some content based on Excel data, such as showing relevant text only when the fee field is not empty. This can be achieved through the conditional statement <code>jinja2</code> syntax supported by <code>docxtpl</code>.</p>
<figure class="highlight django"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">1. </span><span class="template-tag">{% <span class="name"><span class="name">if</span></span> S != 0 %}</span><span class="language-xml">Order the defendant to pay the plaintiff rent of </span><span class="template-variable">{{ S }}</span><span class="language-xml"> yuan;</span></span><br><span class="line"><span class="language-xml">2. </span><span class="template-tag">{% <span class="name"><span class="name">endif</span></span> %}</span><span class="template-tag">{% <span class="name"><span class="name">if</span></span> T != 0 %}</span><span class="language-xml">Order the defendant to pay the plaintiff a fee of </span><span class="template-variable">{{ T }}</span><span class="language-xml"> yuan;</span></span><br><span class="line"><span class="language-xml">3. </span><span class="template-tag">{% <span class="name"><span class="name">endif</span></span> %}</span><span class="template-tag">{% <span class="name"><span class="name">if</span></span> Y != 0 %}</span><span class="language-xml">Order the defendant to pay the plaintiff repair fees of </span><span class="template-variable">{{ Y }}</span><span class="language-xml"> yuan;</span><span class="template-tag">{% <span class="name"><span class="name">endif</span></span> %}</span></span><br></pre></td></tr></tbody></table></figure>

<p>Because there are lists in Word, to maintain the list format and numbering, the <code>{% endif %}</code> needs to be placed in the appropriate position.</p>
<p>In addition to the simple replacements and conditional statements mentioned above, <code>docxtpl</code> also supports loop statements, tables, setting rich text, etc. You can refer to its <a target="_blank" rel="noopener" href="https://docxtpl.readthedocs.io/en/latest/">documentation</a>.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>With just over 100 lines of code, we can implement a program for batch creation of Word documents, which demonstrates the power of Python. Compared to manual copy and paste, the program is incredibly fast, capable of processing hundreds or thousands of documents in 1 minute, and is less prone to errors. For those without a programming background, with the help of ChatGPT teacher, such tasks can also be accomplished. This is a major use of current AI, <strong>allowing everyone to quickly get started with knowledge outside their professional field</strong>, especially in the programming domain.</p>
</div><div class="article-footer-copyright"><p> Written in Chinese, LLM translated into English</p><p>Non-commercial reproduction is allowed with proper attribution to the author and source. </p><p>For commercial reproduction, please contact the <a href="mailto:xuezaigds@gmail.com">author</a></p></div><div class="post-donate"><div class="donate_bar center" id="donate_board"><a class="btn_donate" id="btn_donate" href="javascript:;" title="Sponsor"></a><div class="donate_txt"> ↑<br>Good content, Sponsor it<br></div></div><div class="donate_bar center hidden" id="donate_guide"><img src="https://slefboot-1251736664.file.myqcloud.com/weixin.jpg" title="WeChat Sponsor"><img src="https://slefboot-1251736664.file.myqcloud.com/zhifubao.jpg" title="Alipay Sponsor"></div><script type="text/javascript">document.getElementById('btn_donate').onclick = function(){
    $('#donate_board').addClass('hidden');
    $('#donate_guide').removeClass('hidden');
}</script></div><div class="addthis_sharing_toolbox"></div><div class="tags"><a href="/tags/Python/"><i class="fa fa-tag"></i>Python</a><a href="/tags/ChatGPT/"><i class="fa fa-tag"></i>ChatGPT</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论（请确保 Disqus 可以正常加载）</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://selfboot.cn/en/2023/09/04/batch_docx_replace/';
    this.page.identifier = 'en/2023/09/04/batch_docx_replace/';
    this.page.title = 'Using Python Template Library docxtpl to Batch Create Word Documents';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//xuelangZF.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//xuelangZF.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://xuelangZF.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="https://www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="https://selfboot.cn"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"></i><span>Categories</span></div><ul><li><a href="/en/categories/Programming/">Programming</a> (19)</li><li><a href="/en/categories/Source-Code-Analysis/">Source Code Analysis</a> (16)</li><li><a href="/en/categories/Artificial-Intelligence/">Artificial Intelligence</a> (13)</li><li><a href="/en/categories/Discovery/">Discovery</a> (1)</li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"></i><span>Tags</span></div><div class="tagcloud"><a href="/en/tags/Python/" style="font-size: 15.00px;">Python</a> <a href="/en/tags/Google/" style="font-size: 15.00px;">Google</a> <a href="/en/tags/C/" style="font-size: 15.00px;">C++</a> <a href="/en/tags/ChatGPT/" style="font-size: 15.00px;">ChatGPT</a> <a href="/en/tags/Prompt/" style="font-size: 15.00px;">Prompt</a> <a href="/en/tags/Redis/" style="font-size: 15.00px;">Redis</a> <a href="/en/tags/Debug/" style="font-size: 15.00px;">Debug</a> <a href="/en/tags/eBPF/" style="font-size: 15.00px;">eBPF</a> <a href="/en/tags/Go/" style="font-size: 15.00px;">Go</a> <a href="/en/tags/Frontend/" style="font-size: 15.00px;">Frontend</a> <a href="/en/tags/Gemini/" style="font-size: 15.00px;">Gemini</a> <a href="/en/tags/SEO/" style="font-size: 15.00px;">SEO</a> <a href="/en/tags/LLM/" style="font-size: 15.00px;">LLM</a> <a href="/en/tags/Web/" style="font-size: 15.00px;">Web</a> <a href="/en/tags/LevelDB/" style="font-size: 15.00px;">LevelDB</a></div></div><!-- Debug: page.path = en/2023/09/04/batch_docx_replace/ --><div class="widget"><div class="widget-title"><i class="fa fa-file-o"></i><span>Recent</span></div><ul><li><a href="/en/2025/01/13/leveldb_source_write_batch/" title="LevelDB Explained - Elegant Merging of Write and Delete Operations">LevelDB Explained - Elegant Merging of Write and Delete Operations</a></li><li><a href="/en/2025/01/10/c++_crash_cases/" title="5 Real-world Cases of C++ Process Crashes from Production">5 Real-world Cases of C++ Process Crashes from Production</a></li><li><a href="/en/2025/01/02/leveldb_source_thread_anno/" title="LevelDB Explained - Static Thread Safety Analysis with Clang">LevelDB Explained - Static Thread Safety Analysis with Clang</a></li><li><a href="/en/2024/12/25/leveldb_source_hashtable/" title="LevelDB Explained - How to Design a High-Performance HashTable">LevelDB Explained - How to Design a High-Performance HashTable</a></li><li><a href="/en/2024/09/24/leveldb_source_skiplist_time_analysis/" title="LevelDB Explained - How to Analyze the Time Complexity of SkipLists?">LevelDB Explained - How to Analyze the Time Complexity of SkipLists?</a></li><li><a href="/en/2024/09/18/leveldb_source_skiplist_test/" title="LevelDB Explained - How to Test Parallel Read and Write of SkipLists?">LevelDB Explained - How to Test Parallel Read and Write of SkipLists?</a></li><li><a href="/en/2024/09/13/gpto1_hands_on/" title="Hands-on with OpenAI's o1-preview - Not Better Enough?">Hands-on with OpenAI's o1-preview - Not Better Enough?</a></li><li><a href="/en/2024/09/09/leveldb_source_skiplist/" title="LevelDB Explained - How to implement SkipList">LevelDB Explained - How to implement SkipList</a></li><li><a href="/en/2024/09/05/claude35_prompt/" title="Claude3.5's System Prompts - No Apologies, Face Blind, Hallucinate...">Claude3.5's System Prompts - No Apologies, Face Blind, Hallucinate...</a></li><li><a href="/en/2024/08/29/leveldb_source_utils/" title="LevelDB Explained - Arena, Random, CRC32, and More.">LevelDB Explained - Arena, Random, CRC32, and More.</a></li></ul></div><!-- Debug: Current Language = en, Filtered Posts Count = 10 --><div class="widget" id="toc"><div class="widget-title"><i class="fa fa-list-ul"></i><span> Contents</span></div><ul class="dsq-widget-list"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Simple-Replacement"><span class="toc-number">1.</span> <span class="toc-text">Simple Replacement</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Special-Handling-of-Dates"><span class="toc-number">1.1.</span> <span class="toc-text">Special Handling of Dates</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Complex-Replacement"><span class="toc-number">2.</span> <span class="toc-text">Complex Replacement</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Calculated-Data"><span class="toc-number">2.1.</span> <span class="toc-text">Calculated Data</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Conditional-Statements"><span class="toc-number">2.2.</span> <span class="toc-text">Conditional Statements</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">3.</span> <span class="toc-text">Conclusion</span></a></li></ol></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2025 <a href="/." rel="nofollow">Just For Fun.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/selfboot/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/selfboot"> SelfBoot.</a><p><span id="busuanzi_container_site_pv"></span>Total Site Visits:  <span id="busuanzi_value_site_pv"></span> Times，<span id="busuanzi_container_site_uv"></span>Unique Visitors:  <span id="busuanzi_value_site_uv"></span> People</p></div></div></div><link rel="stylesheet" type="text/css" href="/css/donate.css"><link rel="stylesheet" type="text/css" href="/css/copyright.css"><a class="show" id="rocket" href="#top" aria-label="Back to top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script><script type="text/javascript" src="/js/jquery.fancybox.min.js" defer=""></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" defer=""></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.min.css"><script type="text/javascript" src="/js/toc.js?v=1.0.0"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>